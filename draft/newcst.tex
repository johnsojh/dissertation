% This is a chapter in my dissertation tentatively entitled "A New and
% Simpler Central Sets Theorem".  The new and simpler part is due to a
% different definition of J-sets, which in turns leads to a different
% definition of C-sets.  Happily the new definition is equivalent to
% the old definition.  Therefore no proofs need to be rewritten; but
% there is value in rewriting the proofs, since as this chapter shows,
% the rewritten proofs are often simpler than the old proofs.
%
% N.B. The new definition of J-sets essentially first appears in an
% article, "Ramsey Theory in Noncommutative Semigroups", by Bergelson
% and Hindman in their Theorem 2.6. [6/19/2011 John]

\chapter{Central Sets Theorem}

\section{Hales-Jewett Theorem}
In the article \cite{Hales:1963fk}, Alfred W.~Hales and Robert I.~Jewett abstracted van der Waerden's combinatorial argument into a powerful theorem which implies (among other things) van der Waerden's Theorem itself. 
The vast applicability of the Hales-Jewett Theorem lies in the fact that it relates finite coloring of free semigroups and `combinatorial lines'. 
In this chapter, one of our first tasks shall be to import the notion of a special type of combinatorial line into other types of semigroups. 
However before we can get started we must first state some terminology related to the Hales-Jewett Theorem itself.

\begin{defn}
  Let $A$ be a nonempty finite set, let $\star$ denote an element not in $A$, and let $S$ be the free semigroup generated by $A$.
  \begin{itemize}
    \item[(a)] 
      A \emph{variable word (on $A$)} is a word $w(\star)$ in the free semigroup on the alphabet $A \cup \{\star\}$ in which $\star$ occurs.

    \item[(b)] 
      Given a variable word $w(\star)$ on $A$ and $a \in A$, we let $w(a)$ denote the word in $S$ where each occurrence of $\star$ in $w(\star)$ is replaced by $a$.

    \item[(c)] 
      Given a variable word $w(\star)$ on $A$ we call the set $\{\, w(a) : a \in A \,\}$ a \emph{combinatorial line}.
  \end{itemize}
\end{defn}

\begin{hj}
  Let $A$ be a nonempty finite set, let $S$ be the free semigroup generated by $A$, and let $r$ be a positive integer.
  If $S = \bigcup_{i=1}^r C_i$, then there exists $i \in \{1, 2, \ldots, r\}$ such that $C_i$ contains a combinatorial line, that is, there exists a variable word $w(\star)$ with $\bigl\{\, w(a) : a \in A \,\bigr\} \subseteq C_i$.
\end{hj}

To import the notion of a combinatorial line into other semigroups we shall specialize the notion of a combinatorial line to require that it begins and ends with a constant letter, and that there are no two adjacent variable letters.
The following theorem shows that the conclusion of the Hales-Jewett Theorem may be strengthened to these specialize combinatorial lines.  

\begin{thm}
  \label{thm:special-hj}
  Let $r$ be a positive integer and $A$ a nonempty finite set.
  If $S$ is the free semigroup generated by $A$ and $S = \bigcup_{i=1}^r C_i$, then there exist $i \in \{1, 2, \ldots, r\}$ and a variable word $w(\star)$ which begins and ends with a constant letter and has no two adjacent variable letters such that $\bigl\{\, w(a) : a \in A \,\bigr\} \subseteq C_i$.
\end{thm}
\begin{proof}
  Define the function $\varphi \colon S \to \{1, 2, \ldots, r\}$ by $\varphi(w) = \min\{i : w \in C_i\}$. 
  Fix $b \in A$ and define $\psi \colon S \to S$ as follows: if $w \in S$ and $w = a_1a_2 \cdots a_n$ with each $a_i \in A$, then $\psi(w) = ba_1ba_2b\cdots a_nb$.
  We have that $\varphi \circ \psi \colon S \to \{1, 2, \ldots, r\}$.
  By the Hales-Jewett Theorem, pick $i \in \{1, 2, \ldots, r\}$ and a variable word $w(\star)$ such that $\{\, w(a) : a \in A \,\} \subseteq (\varphi \circ \psi)^{-1}[\{i\}]$.
  Observe that $\psi\bigl(w(\star)\bigr)$ is a variable word that begins and ends with a constant, doesn't have any adjacent variable letters, and $\{\, \psi\bigl(w(a)\bigr) : a \in A \} \subseteq C_i$.
\end{proof}

Let $k$ be a positive integer.
In the following theorem, we consider $\{1, 2, \ldots, k\}$ as a finite alphabet on $k$ symbols, and for every $n \in \bbN$, we consider $\{1, 2, \ldots, k\}^n$ as the set of all length $n$ words generated by $\{1, 2, \ldots, k\}$.

\begin{thm}
  \label{thm:finitary-shj}
  For each $k$ and $r$ in $\bbN$ there exists $n \in \bbN$ such that whenever $\{1, 2, \ldots, k\}^n$ is $r$-colored, that is, $\varphi \colon \{1, 2, \ldots, k\}^n \to \{1, 2, \ldots, r\}$, there exists a variable word $w(\star)$ which begins and ends with a constant letter and has no two adjacent variable letters such that $\bigl\{\, w(i) : i \in \{1, 2, \ldots, k\} \,\bigr\}$ is constant on $\varphi$.
\end{thm}
\begin{proof}
  Let $k$ and $r$ be given and suppose that the conclusion fails.
  That is for each $n \in \bbN$ choose an $r$-coloring $\varphi_n \colon \{1, 2, \ldots, k\}^n \to \{1, 2, \ldots, r\}$ such that no variable word which begins and ends with a constant and has no two adjacent variable letters is constant on $\varphi_n$.
  
  Put $S = \bigcup_{n=1}^\infty \{1, 2, \ldots, k\}^n$ and define $\varphi \colon S \to \{1, 2, \ldots, r\}$ as follows: If $w$ is a length $n$ word with $w = (x_1, x_2, \ldots, x_n)$ and each $x_i \in \{1, 2, \ldots, k\}$, then $\varphi(w) = \varphi_n(w)$.
  By Theorem \ref{thm:special-hj} pick $i \in \{1, 2, \ldots, r\}$ and a variable word $w(\star)$ which beings and ends with a constant letter and has no two adjacent variable letters with $\bigl\{\, w(i) : i \in \{1, 2, \ldots, k\} \,\bigr\} \subseteq \varphi^{-1}[\{i\}]$.
  Suppose that the length of $w(\star)$ is $n$, then, $\varphi_n$ is constant on $\bigl\{\, w(i) : i \in \{1, 2, \ldots, k\} \,\bigr\}$, a contradiction. 
\end{proof}

\section{$J$-sets}
The way we shall import the notion of our specialized combinatorial line into other semigroups is by defining the concept of a $J$-set. 
In what follows if $A$ and $B$ are sets, we let $\setfunc{A}{B}$ represent the collection of all functions with domain $A$ and codomain $B$.

\begin{defn}
  Let $(S, \cdot)$ be a semigroup.
  \begin{itemize}
    \item[(b)] 
      For each $m \in \bbN$, define
      \[
        \calJ_m = \{\, (t_1, t_2, \ldots, t_m) \in \bbN^m : t_1 < t_2 < \cdots < t_m \,\}.
      \]

    \item[(b)] 
      Put $\calT(S) = \setfunc{\bbN}{S}$.
      If the semigroup is clear from context, we write $\calT$ instead of $\calT(S)$.

    \item[(c)] 
      For each $m \in \bbN$, $a \in S^{m+1}$, $t \in \calJ_m$, and $f \in \calT$, put
      \[
        \textstyle
        x(m, a, t, f) = \Bigl( \prod_{i=1}^m \bigl( a(i)f(t_i) \bigr) \Bigr)a(m+1).
      \]

    \item[(d)] 
      We call a subset $A \subseteq S$ a \emph{$J$-set (in $S$)} if and only if for every $F \in \Pf(\calT)$ there exist $m \in \bbN$, $a \in S^{m+1}$, and $t \in \calJ_m$ such that for each $f \in F$ we have $x(m, a, t, f) \in A$.
  \end{itemize}
\end{defn}
\begin{rmk}
  Despite appearances to the contrary, I must point out that $J$-sets are \textsl{not} named after the author!
  In particular, the term $J$-set is derived from the term $J_Y$ set which first appeared as a definition in \cite[Definition 2.4(b)]{Hindman:1996fk}.
\end{rmk}

Our definition of a $J$-set looks different from the definitions given in \cite[Definition 2.2(a)]{Hindman:2009vn} and \cite[Definition 3.3(d)]{De:2008uq}.
The first results we prove about $J$-sets shall be that all of these definitions are equivalent.
However before proving this result we introduce some notation that is analogous to $\calJ_m$.

\begin{defn}
  For each $m \in \bbN$ define
  \begin{align*}
    \calI_m &= \Bigl\{\, \bigl( H(1), H(2), \ldots, H(m) \bigr) : \hbox{$H(i) \in \mathcal{P}_f(\bbN)$ for all $i \in \{1, 2, \ldots, m\}$} \\
        &\hspace{3em} \hbox{ and $\max H(i) < \min H(i+1)$ for all $i \in \{1, 2, \ldots, m-1\}$} \Bigr\}.
  \end{align*}
\end{defn}

Given a $A$, a subset of some semigroup $S$, in \cite[Definition 2.2(a)]{Hindman:2009vn} $A$ is considered a $J$-set if and only if for every $F \in \Pf(\calT)$, there exists $m \in \bbN$, $a \in S^{m+1}$, and $H \in \calI_m$ such that for all $f \in F$, $\Bigl( \prod_{i=1}^n\bigl( a(i) \prod_{t \in H(i)} f(t) \bigr) \Bigr) a(m+1) \in A$.
To show that our definition of a $J$-set is equivalent to \cite[Definition 2.2(a)]{Hindman:2009vn} we will use the following technical `rewriting' lemma.

\begin{lem}
  \label{lem:rewrite-jset}
  Let $(S, \cdot)$ be a semigroup, $m \in \bbN$, $a \in S^{m+1}$, $H \in \calI_m$, and $F \in \Pf(\calT)$. 
  Fix $b \in S$ and for each $f \in F$ define $g_f \in \calT$ by $g_f(t) = f(t)b$. 
  Then there exists $n \in \bbN$, $c \in S^{n+1}$, and $t \in \calJ_n$ such that for all $f \in F$, $x(n, c, t, f) = \prod_{i=1}^m \bigl( a(i) \prod_{t \in H(i)} g_f(t)\big) a(m+1)$.
\end{lem}
\begin{proof}
  Put $H(0) = \emptyset$ and for each $s \in \{0, 1, \ldots, m\}$ define $h_s = \sum_{i=0}^s |H(i)|$.
  Put $n = h_m$ and enumerate $\bigcup_{i=1}^m H(i)$ as a strictly increasing sequence $t_1 < t_2 < \cdots < t_n$ in $\bbN$. 
  We will adopt some temporary terminology and say that for $f \in F$, $\prod_{i=1}^m \bigl( a(i) \prod_{t \in H(i)} g_f(t) \bigr) a(m+1)$ has \emph{proper representation} if and only if $\prod_{i=1}^m \bigl( a(i) \prod_{t \in H(i)} g_f(t) \bigr) a(m+1) = x(n, c, t, f)$ where $c \in S^{n+1}$ is defined as follows:
  \[
    c(j) = 
    \begin{cases}
      a(1) & \mbox{if $j = 1$;} \\
      b & \mbox{if $s \in \{0, 1, \ldots, m-1\}$ and} \\
      &   \hspace{2em}\mbox{$2+h_s \le j \le h_{s+1}$; and} \\
      ba(s+1) & \mbox{if $s \in \{1, 2, \ldots, m\}$ and $j = 1+h_s$.}
    \end{cases}
  \]
  {
    (To see how our $c$ was derived let's consider a reasonable small example with $m = 3$, $H(1) = \{3, 5\}$, $H(2) = \{7\}$, and $H(3) = \{9, 11, 15\}$.
    With these numbers we have
    \begin{align*}
      \textstyle
      \prod_{i=1}^3 \bigl( a(i) \prod_{t \in H(i)} g(t) \bigr) a(4) &=
      a(1) g(3)g(5) a(2) g(7) a(3) g(9)g(11)g(15) a(4) \\
      &= a(1) f(3)bf(5)b a(2) f(7)b a(3) f(9)bf(11)bf(15)b a(4).
    \end{align*}
    Therefore $n = 6$, $c(1) = a(1)$, $c(2) = b$, $c(3) = ba(2)$, $c(4) = ba(3)$, $c(5) = b$,  $c(6) = b$, and $c(7) = ba(4)$.)
  }

  We prove that for $f \in F$, $\prod_{i=1}^m \bigl( a(i) \prod_{t \in H(i)} g_f(t) \bigr) a(m+1)$ has proper representation by induction on $m$. 
  First suppose that $m = 1$, then 
  \[
    \textstyle
    \prod_{i=1}^1 \bigl( a(i) \prod_{t \in H(i)} g_f(t) \bigr) a(2) = a(1) f(t_1)b  f(t_2)b \cdots f(t_n)b a(2).
  \]
  In this case $h_0 = 0$, $h_1 = n$, and so $s$ can only be 0 or 1.
  If $2+h_0 = 2 \le j \le h_1 = n$, then by definition of $c$ we have $c(j) = b$ for all $j \in \{2, 3, \ldots, n\}$. 
  Also since $1 + h_1 = n+1$, we have $c(n+1) = ba(2)$. 
  Therefore
  \[
    \textstyle
    a(1) f(t_1)b  f(t_2)b \cdots f(t_n)b a(2) = c(1) f(t_1) c(2) f(t_2) c(3) \cdots f(t_n) c(n+1),
  \]
  and so $\prod_{i=1}^1 \bigl( a(i) \prod_{t \in H(i)} g_f(t) \bigr) a(2)$ has proper representation. 

  Now let $m > 1$ and assume that $\prod_{i=1}^{m-1} \bigl( a(i) \prod_{t \in H(i)} g_f(t) \bigr) a(m)$ has proper representation with $\prod_{i=1}^{m-1} \bigl( a(i) \prod_{t \in H(i)} g_f(t) \bigr) a(m) = x(n, c, t, f)$. 
  Then we have 
  \begin{align*}
    \textstyle
    \prod_{i=1}^{m} \bigl( a(i) \prod_{t \in H(i)} g_f(t) \bigr) a(m+1) &= \textstyle
    \prod_{i=1}^{m-1} \bigl( a(i) \prod_{t \in H(i)} g_f(t) \bigr) a(m) \prod_{t \in H(m)} g_f(t) a(m+1), \\
    &= \textstyle 
    x(n, c, t, f) \prod_{t \in H(m)} g_f(t) a(m+1).
  \end{align*}
  Now $c(n+1) \prod_{t \in H(m)} g_f(t) a(m+1)$ has proper representation, say with, 
  \[
    \textstyle
    \prod_{t \in H(m)} g_f(t) a(m+1) = x(p, d, u, f).
  \]
  By translating the indices for $u$ and $d$ it follows that 
  \[
    \textstyle
    \prod_{i=1}^{m} \bigl( a(i) \prod_{t \in H(i)} g_f(t) \bigr) a(m+1)
  \]
  has proper representation.
\end{proof}

\begin{thm}
  Let $(S, \cdot)$ be a semigroup and $A$ a subset of $S$.
  The following are equivalent. 
  \begin{itemize}
    \item[(a)] $A$ is a $J$-set.
    \item[(b)] For all $F \in \Pf(\calT)$, there exist $m \in \bbN$, $a \in S^{m+1}$, and $H \in \calI_m$ such that for all $f \in F$ we have $\prod_{i=1}^m\bigl( a(i) \prod_{t \in H(i)} f(t) \bigr) a(m+1) \in A$.
  \end{itemize}
\end{thm}
\begin{proof}
  \textsl{(a) $\Rightarrow$ (b)}
  Let $F \in \Pf(\calT)$ and pick $m \in \bbN$, $a \in S^{m+1}$, and $t \in \calJ_m$ as guaranteed. 
  For each $i \in \{1, 2, \ldots, m\}$ put $H(i) = \{ t_i\}$. 
  Then $H \in \calI_m$ and the conclusion follows. 

  \textsl{(b) $\Rightarrow$ (a)}
  Let $F \in \Pf(\calT)$ and fix $b \in S$.
  For each $f \in F$, define $g_f \in \calT$ by $g_f(t) = f(t)b$. 
  By assumption, there exist $m \in \bbN$, $a \in S^{m+1}$, and $H \in \calI_m$ such that for every $f \in F$ we have $\prod_{i=1}^m \bigl( a(i) \prod_{t \in H(i)} g_f(t) \bigr) a(m+1) \in A$.
  By Lemma \ref{lem:rewrite-jset}, there exists $n \in \bbN$, $c \in S^{n+1}$, and $t \in \calJ_n$ such that for all $f \in F$, $x(n, c, t, f) = \prod_{i=1}^m \bigl( a(i) \prod_{t \in H(i)} g_f(t) \bigr) a(m+1) \in A$.
\end{proof}

With this theorem all of the results previously proved about $J$-sets apply  with our definition.
However in this chapter, we choose to reprove these results primarily to show how the proofs can be simplified with the `new' definition of $J$-set.

The first result we (re)prove is \cite[Lemma 2.4]{Hindman:2010fk} which shows that when the underlying semigroup is commutative the definition of a $J$-set is considerably simplified. 

\begin{lem}
  \label{lem:comm-jsets}
  Let $(S, +)$ be a commutative semigroup and let $A \subseteq S$. 
  Then $A$ is a $J$-set if and only if for every $F \in \Pf(\calT)$, there exist $a \in S$ and $H \in \Pf(\bbN)$ such that for all $f \in F$, $a + \sum_{t \in H} f(t) \in A$.
\end{lem}
\begin{proof}
  ($\Rightarrow$)
  Let $F \in \Pf(\calT)$.
  Pick $m \in \bbN$, $a \in S^{m+1}$, and $t \in \calJ_m$ such that $x(m, a, t, f) \in A$ for each $f \in F$.
  Put $b = \sum_{i=1}^{m+1} a(i)$ and $H = \{t_1, t_2, \ldots, t_m\}$.
  Since $S$ is commutative we have that $b + \sum_{t \in H} f(t) = x(m, t, a, f) \in A$.

  ($\Leftarrow$)
  Let $F \in \Pf(\calT)$ and fix $b \in S$.
  For each $f \in F$ define $g_f \in \calT$ by $g_f(t) = f(t)+b$. 
  Pick $a \in S$ and $H \in \Pf(\bbN)$ such that for all $f \in F$, $a + \sum_{t \in H} g_f(t) \in A$. 
  Put $m = |H|$ and enumerate $H$ as a strictly increasing sequence $t_1 < t_2 < \cdots < t_m$. 
  Define $c \in S^{m+1}$ by $c(1) = a$ and $c(i) = b$ for every $i \in \{2, 3, \ldots, m+1\}$.
  Then $x(m, c, t, f) = a + \sum_{t \in H} g_f(t) \in A$.
\end{proof}

We next show that $J$-sets satisfy a superficially stronger condition.
(In \cite[Definition 3.3(e)]{De:2008uq} this superficially stronger condition was originally used to define a $J$-set.)

\begin{lem}
  \label{lem:jset-start}
  Let $(S, \cdot)$ be a semigroup and $A$ a $J$-set in $S$.
  Then for every $F \in \Pf(\calT)$ and each positive integer $n$ there exist $m \in \bbN$, $a \in S^{m+1}$, and $t \in \calJ_m$, with $t_1 > n$ such that for all $f \in F$, $x(m, a, t, f) \in A$.
\end{lem}
\begin{proof}
  For each $f \in F$ define $g_f \in \calT$ by $g_f(t) = f(n+t)$.
  Since $A$ is a $J$-set, pick $m \in \bbN$, $a \in S^{m+1}$, and $t \in \calJ_m$ such that for all $f \in F$, $x(m, a, t, g_f) \in A$. 
  Define $u \in \calJ_m$ by $u_i =  n + t_i$.
  Then $x(m, a, u, f) = x(m, a, t, g_f) \in A$ for every $f \in F$.
\end{proof}

The next result we reprove is \cite[Theorem 3.4]{De:2008uq} which states that the collection of all ultrafilters on a semigroup, each of whose member is a $J$-set, is a closed ideal.
To state this result we introduce the following notation.

\begin{defn}
  Let $(S, \cdot)$ be a semigroup. 
  Define
  \[
    J(S) = \{\, p \in \beta S : \mbox{for every $A \in p$, $A$ is a $J$-set} \,\}.
  \]
\end{defn}

\begin{thm}
  Let $(S, \cdot)$ be a semigroup.
  If $J(S)$ is nonempty, then $J(S)$ is a closed two-sided ideal of $\beta S$.
\end{thm}
\begin{proof}
  Let $p \not\in J(S)$ and pick $A \in p$ such that $A$ is not a $J$-set.
  By definition of $J(S)$ we must have $\overline{A} \cap J(S) = \emptyset$.
  Since $\overline{A}$ is a (basic) open neighborhood of $p$, it follows that $J(S)$ is topologically closed in $\beta S$.

  Now let $p \in J(S)$ and $q \in \beta S$.
  To see that $J(S)$ is an ideal, we show that $pq \in J(S)$ and $qp \in J(S)$. 

  We first show that $pq \in J(S)$.
  Let $F \in \Pf(\calT)$, let $A \in pq$, and put $B = \{\, x \in S : x^{-1}A \in q \,\}$.
  Then $B \in p$ and so $B$ is a $J$-set.
  Pick $m \in \bbN$, $a \in S^{m+1}$, and $t \in \calJ_m$ such that for all $f \in F$ we have $x(m, a, t, f) \in B$.
  By definition of $B$ this means that for all $f \in F$, $x(m, a, t, f)^{-1}A \in q$. 
  Since $q$ is an ultrafilter and $F$ is finite, we have $\bigcap_{f \in F} x(m, a, t, f)^{-1}A \in q$, and therefore, $\bigcap_{f \in F} x(m, a, t, f)^{-1}A \ne \emptyset$.
  Pick $b \in \bigcap_{f \in F} x(m, a, t, f)^{-1}A$ and define $c \in S^{m+1}$ by
  \[
    c =
    \begin{cases}
      a(j) & \mbox{if $j \in \{1, 2, \ldots, m\}$,} \\
      a(m+1)b & \mbox{if $j = m+1$.}
    \end{cases}
  \]
  Therefore, for each $f \in F$, $x(m, c, t, f) \in A$, that is, $A$ is a $J$-set and so $pq \in J(S)$.

  Now we show that $qp \in J(S)$.
  Again let $F \in \Pf(\calT)$, let $A \in qp$, and put $B = \{\, x \in S : x^{-1}A \in p \,\}$.
  Then $B \in q$, and therefore $B \ne \emptyset$.
  Pick $b \in B$, then $b^{-1}A \in p$ and so $b^{-1}A$ is a $J$-set.
  Pick $m \in \bbN$, $a \in S^{m+1}$, and $t \in \calJ_m$ such that for all $f \in F$, we have $x(m, a, t, f) \in b^{-1}A$.
  Define $c \in S^{m+1}$ by
  \[
    c =
    \begin{cases}
      ba(1) & \mbox{if $j =1$,} \\
      a(j) & \mbox{if $j \in \{2, \ldots, m, m+1\}$.}
    \end{cases}
  \]
  Therefore, for each $f \in F$, $x(m, c, t, f) \in A$, that is, $A$ is a $J$-set and so $qp \in J(S)$.
\end{proof}

It is clear that every semigroup $S$ is a $J$-set in itself, but this easy fact doesn't necessarily imply that $J(S) \ne \emptyset$.
It's true that $J(S)$ \emph{is} nonempty but this nontrivial fact follows either from the fact that piecewise syndetic sets are $J$-sets, Lemma \ref{lem:pr-jsets} and \cite[Theorem 3.11]{Hindman:1998fk}, or the Central Sets Theorem.%
\endnote{
  The fact that $J(S)$ is nonempty was first proved via the Central Sets Theorem in \cite[Theorem 3.8]{De:2008uq}.
  The proof that $J$-sets are partition regular was first proved in \cite[Theorem 2.14]{Hindman:2010fk}. 
  The proof that piecewise syndetic sets are $J$-sets is new.
}

We start by proving that piecewise syndetic sets are $J$-sets.
The following result is modeled after \cite[Theorems 14.1 and 14.7]{Hindman:1998fk}. 

\begin{thm}
  Let $(S, \cdot)$ be a semigroup and $A \subseteq S$ piecewise syndetic.
  Then $A$ is also a $J$-set.
\end{thm}
\begin{proof}
  Let $F \in \calT$, put $k = |F|$, and enumerate $F$ as $\{f_1, f_2, \ldots, f_k\}$.
  Put $Y = \bigtimes_{t=1}^k \beta S$. 
  Then with the product topology $Y$ is a compact right-topological semigroup by \cite[Theorem 2.22]{Hindman:1998fk}.
  For each $i \in \bbN$ define
  \begin{align*}
    I_i &= \Bigl\{\, \bigl( x(m, a, t, f_1), x(m, a, t, f_2), \ldots,
    x(m, a, t, f_k) \bigr) : \mbox{$m \in \bbN$, $a \in S^{m+1}$,} \\
    &\hspace{5em} \mbox{$t \in \calJ_m$, and $t_1 > i$}
    \,\Bigr\},
  \end{align*}
  and put $E_i = I_i \cup \{\, (a, a, \ldots, a) : a \in S \,\}$.
  Let $I = \bigcap_{i=1}^\infty c\ell_Y(I_i)$ and let $E = \bigcap_{i=1}^\infty c\ell_Y(E_i)$.

  Observe that $I$ and $E$ are nonempty closed subsets of $Y$.
  (Since each $I_i \ne \emptyset$ and $I_{i+1} \subseteq I_i$.)

  We claim that $E$ is a subsemigroup of $Y$ and $I$ is an ideal of $E$.
  Let $p$, $q \in E$, $U$ be an open neighborhood of $pq$, and let $i \in \bbN$. 
  Since $\rho_q$ is continuous, pick $V$ a neighborhood of $p$ such that $Vq \subseteq U$. 
  If $p \in I$, then pick $\vec{x} \in I_i \cap V$; otherwise pick $\vec{x} \in E_i \cap V$.
  If $\vec{x} \in I_i$, then pick $m \in \bbN$, $a \in S^{m+1}$, and $t \in \calJ_m$ with $t_1 > i$ such that
  \[
    \vec{x} = \bigl( x(m, a, t, f_1), x(m, a, t, f_2), \ldots, x(m,
    a, t, f_k) \bigr)
  \]
  In this case put $j = t_m$, otherwise put $j=i$. 

  Since $\lambda_{\vec{x}}$ is continuous, pick $W$ a neighborhood of $q$ such that $xW \subseteq U$. 
  If $q \in I$, then pick $\vec{y} \in I_j \cap W$, otherwise pick $\vec{y} \in E_j \cap W$.
  Then $\vec{x} \vec{y} \in E_i \cap U$, and if $p \in I$ or $q \in I$, then $\vec{x} \vec{y} \in I_i \cap U$. 
  Hence, it follows that $E$ is a subsemigroup of $Y$ and $I$ is an ideal of $E$.

  Pick $p \in K(\beta S) \cap \overline{A}$ and put $\overline{p} = (p, p, \ldots, p)$. 
  Since $K(Y) = \bigtimes_{t=1}^k K(\beta S)$ (by \cite[Theorem 2.23]{Hindman:1998fk}), we have that $\overline{p} \in K(Y)$. 
  We show that $\overline{p} \in E$.
  Let $U$ be a neighborhood of $\overline{p}$ and pick $B_1$, $B_2$, \dots, $B_l \in p$ such that $\bigtimes_{t=1}^k \overline{B_t} \subseteq U$. 
  Pick $a \in \bigcap_{t=1}^k B_t$, then $(a, a, \ldots, a) \in U \cap E_i$ for all $i \in \bbN$. 
  Hence $\overline{p} \in E$ and moreover $\overline{p} \in K(Y) \cap E$.

  Since $K(Y) \cap E \ne \emptyset$, by Theorem \ref{thm:smallest-subsemigrp} we have $K(E) = K(Y) \cap E$.
  Therefore $\overline{p} \in K(E) \subseteq I$.
  Hence $I_i \cap \bigtimes_{i=1}^k A \ne \emptyset$ for all $i \in \bbN$ and so our conclusion follows.
\end{proof}

\begin{cor}
  Let $(S, \cdot)$ be a semigroup, then $c\ell\bigl( K(\beta S) \bigr) \subseteq J(S)$.
\end{cor}
\begin{proof}
  Let $p \in c\ell\bigl( K(\beta S) \bigr)$ and $A \in p$.
  By \cite[Corollary 4.41]{Hindman:1998fk}, $A$ is a piecewise syndetic set and so $A$ is a $J$-set.
  Therefore $p \in J(S)$.
\end{proof}

\begin{cor}
  If $A \subseteq \bbN$ be a piecewise syndetic set, then $A$ is also an $AP$-set. 
\end{cor}
\begin{proof}
  Since $A$ is also a $J$-set, it suffices to show that all $J$-sets in $\bbN$ are $AP$-sets. 
  Let $k$ be a positive integer and let $\la x_n \ra_{n=1}^\infty$ be a sequence in $\bbN$. 
  For each $i \in \{1, 2, \ldots, k\}$ put $f_i(t) = i \cdot x_t$.
  Since $A$ is a $J$-set, pick $a \in \bbN$ and $H \in \Pf(\bbN$ such that for all $i \in \{1, 2, \ldots, k\}$, $a + \sum_{t \in H} f_i(t) \in A$. 
  Put $d = \sum_{t \in H} x_t$ and observe that for all $i \in \{1, 2, \ldots, k\}$ we have
  \begin{align*}
    a+id &= \textstyle a+ i(\sum_{t \in H} x_t) = a + \sum_{t \in H} ix_t, \\
    &= \textstyle a + \sum_{t \in H} f_i(t) \in A. 
  \end{align*}
  Hence $A$ is an $AP$-set.
\end{proof}

We now provide another proof, that when combined with \cite[Theorem 3.11]{Hindman:1998fk}, proves that $J(S)$ is nonempty.

\begin{lem}
  \label{lem:pr-jsets}
  Let $(S, \cdot)$ be a semigroup with $A_1 \subseteq S$ and $A_2 \subseteq S$.
  If $A_1 \cup A_2$ is a $J$-set, then either $A_1$ is a $J$-set or $A_2$ is a $J$-set.
\end{lem}
\begin{proof}
  Suppose, to the contrary, that both $A_1$ and $A_2$ are \emph{not} $J$-sets.
  Pick $F_1$ and $F_2$ in $\Pf(\calT)$ such that for all $m \in \bbN$, every $a \in S^{m+1}$, and every $t \in \calJ_m$, there exist $f \in F_1$ and $g \in F_2$ such that $x(m, a, t, f) \not\in A_1$ and $x(m, a, t, g) \not\in A_2$.
  Let $F = F_1 \cup F_2$, put $k = |F|$, and enumerate $F$ as $\{f_1, f_2, \ldots, f_k\}$.

  By Theorem \ref{thm:finitary-shj} pick $n \in \bbN$ such that whenever $\{1, 2, \ldots, k\}^n$ is 2-colored there exists a variable word $w(\star)$ which begins and ends with a constant letter, with no two adjacent variable, and for which the combinatorial line $\bigl\{\, w(\ell) : \ell \{1, 2, \ldots, k\} \,\bigr\}$ is constant under the mapping. 

  Now for each $w = (x_1, x_2, \ldots, x_n) \in \{1, 2, \ldots, k\}^n$ define $g_w \in \calT$ by $g_w(t) = \prod_{i=1}^n f_{x_i}(nt + i)$.
  We have, by hypothesis, that $A_1 \cup A_2$ is a $J$-set and since $\{1, 2, \ldots, k\}^n$ is finite, we may pick $m \in \bbN$, $a \in S^{m+1}$, and $t \in \calJ_m$ such that for all $w \in \{1, 2, \ldots, k\}^n$, $x(m, a, t, g_w) \in A$.

  Define the function $\varphi \colon \{1, 2, \ldots, k\}^n \to \{1, 2\}$ as follows:
  \[
    \varphi(w) = 
    \begin{cases}
      1 & \mbox{if $x(m, a, t, g_w) \in A_1$, and} \\
      2 & \mbox{otherwise.}
    \end{cases}
  \]
  Since $\varphi$ is a 2-coloring of $\{1, 2, \ldots, k\}^n$ we may apply Theorem \ref{thm:finitary-shj} to pick a variable word $w(\star)$ which begins and ends with a constant letter, with no two adjacent variable letters, and for which the $varphi$ is constant on the combinatorial line $\bigl\{\, w(\ell) : \ell \in \{1, 2, \ldots, k\} \,\bigr\}$. 
  Without loss of generality we may suppose that $\varphi \bigl( w(\ell) \bigr) = 1$ for every $\ell \in \{1, 2, \ldots, k\}$.

  We claim that there exist $r \in \bbN$, $c \in S^{mr+1}$, and $s \in \calJ_{mr}$ such that for all $\ell \in \{1, 2, \ldots, k\}$ we have $x(mr, c, s, f_\ell) = x(m, a, t, g_{w(\ell)}) \in A_1$. 
  Observe that if we prove our claim, then we will have arrived at a contradiction. 
  Therefore for the rest of the proof we focus only on rewriting $x(m, a, t, g_{w(\ell)})$ into the appropriate form.

  Let $w(\star) = (x_1, x_2, \ldots, x_n)$ with each $x_i \in \{1, 2, \ldots, k\} \cup \{\star\}$. 
  Let $r$ be the number of variable letters in $w(\star)$, and if $r > 1$ for each $i \in \{1, 2, \ldots, r-1\}$, let $b_i$ be the position of the \mbox{$i$th} variable letter in $w(\star)$ and let $b_0$ be the position of the \mbox{$r$th} variable letter.
  (For instance, if $k = 4$ and $n = 10$, $w(\star) = (1, \star, 1, 4, \star, 2, \star, 3, 3, 1)$, then $r = 3$, $b_1 = 2$, $b_2 = 5$, and $b_0 = 7$.
  The reason we let $b_0$ represent the position of the \mbox{$r$th} variable letter is because we will be performing modulo arithmetic on the index of the $b$'s.)

  For each $i \in \{1, 2, \ldots, mr\}$ define $s_i = nt_{\lceil i/r \rceil} + b_{i \bmod r}$.
  Observe that $r \le n/2$, and since $t_1 < t_2 < \cdots < t_m$, it follows that $s = (s_1, s_2, \ldots, s_{mr}) \in \calJ_{mr}$.

  To define $c \in S^{mr+1}$ we will make use of some further helpful notation. 
  Let $L = \bigl( L(1), L(2), \ldots, L(r+1) \bigr)$ be a partition of $\{1, 2, \ldots, n\} \setminus \{b_1, b_2, \ldots, b_0\}$ such that each $L(i)$ is nonempty and $\max L(i) < \min L(i+1)$ for every $i \in \{1, 2, \ldots, r\}$. 
  For arithmetical convenience put $L(0) = L(r)$. 
  (For instance, if $k = 4$, $n = 10$, $w(\star) = (1, \star, 1, 4, \star, 2, \star, 3, 3, 1)$, then $L(1) = \{1\}$, $L(2) = \{3,4\}$, $L(3) = \{6\}$, $L(4) = \{8, 9, 10\}$, and $L(0) = \{6\}$.)

  Now we define $c \in S^{mr+1}$ as follows:
  \[
    c(i) = 
    \begin{cases}
      a(1)\prod_{j \in L(1)} f_j(nt_1 + j) & \mbox{if $i = 1$,} \\
      \prod_{j \in L(i \bmod r)}  f_j(nt_{\lceil i/(r+1) \rceil} + j) & \mbox{if $i \not\equiv 1 \pmod r$, }\\
      \prod_{j \in L(r+1)} \bigl( f_j(nt_{\lceil i/(r+1) \rceil} + j) \bigr) a\bigl( \lceil (i+1)/(r+1) \rceil \bigr) & \\
      \hspace{2em} \cdot\prod_{j \in L(1)} f_j(nt_{\lceil (i+1)/(r+1) \rceil} + j) & \mbox{if $i \bmod r \equiv 1$ and $i \ne mr +1$, }\\
      \prod_{j \in L(r+1)} \bigr( f_i(nt_m + j) \bigr) a(m+1) & \mbox{if $i = mr + 1$.}
    \end{cases}
  \]

  Then we have that $x(mr, c, s, f_\ell) = x(m, a, t, g_{w(\ell)})$ for all $\ell \in \{1, 2, \ldots, k\}$.
\end{proof}

With Lemma \ref{lem:pr-jsets} we can prove a stronger relationship between $J$-sets and $J(S)$.

\begin{thm}
  \label{thm:jsets-ideal}
  Let $(S, \cdot)$ be a semigroup and $A \subseteq S$.
  Then $J(S) \cap \overline{A} \ne \emptyset$ if and only if $A$ is a $J$-set.
\end{thm}
\begin{proof}
  ($\Rightarrow$)
  Let $p \in J(S) \cap \overline{A}$. 
  Since $p \in J(S)$, every member of $p$ is a $J$-set.
  Hence $A$ is a $J$-set.

  ($\Leftarrow$)
  Suppose $A$ is a $J$-set. 
  By Lemma \ref{lem:pr-jsets} and \cite[Theorem 3.11]{Hindman:1998fk}, there exists an ultrafilter $p \in \beta S$ such that $A \in p$ and every member of $p$ is a $J$-set. 
  Therefore $p \in J(S)$.
\end{proof}


\section{Central Sets Theorem}
The final proof that $J(S)$ is nonempty follows from the Central Sets Theorem.
\begin{defn}
  \label{defn:csets}
  Let $(S, \cdot)$ be a semigroup and $A \subseteq S$.
  We call $A$ a \textsl{$C$-set} if and only if there exist $m \colon \Pf(\calT) \to \bbN$, $\alpha \in \bigtimes_{F \in \Pf(\calT)} S^{m(F)+1}$, and $\tau \in \bigtimes_{F \in \Pf(\calT)} \calJ_{m(F)}$ such that 
  \begin{itemize}
    \item[(1)] if $F$, $G \in \Pf(\calT)$ with $F \subsetneq G$, then $\tau(F)\bigl( m(F) \bigr) < \tau(G)(1)$, and
    \item[(2)] whenever $n \in \bbN$, $G_1$,$G_2$, \dots, $G_n \in \Pf(\calT)$  with $G_1 \subsetneq G_2 \subsetneq \cdots \subsetneq G_n$, and for each $i \in \{1, 2, \ldots, n\}$, $f_i \in G_i$, then we have $\prod_{i=1}^n x(m(G_i), \alpha(G_i), \tau(G_i), f_i) \in A$.
  \end{itemize}
\end{defn}

We now prove that $C$-sets and idempotents in $J(S)$ are closely related.
This proof uses the powerful \cite[Lemma 14.9]{Hindman:1998fk} which we now state.

\begin{lem}[{\cite[Lemma 14.9]{Hindman:1998fk}}]
  Let $F$ be a set, $(D, \le)$ a directed set, and let $(S, \cdot)$ be a semigroup.
  Let $\la T_i \ra_{i \in D}$ be a decreasing family of subsets of $S$ such that for each $i \in D$ and $x \in T_i$, there exists $j \in D$ with $xT_j \subseteq T_i$.
  Put $\mathbf{Q} = \bigcap_{i \in D} c\ell_{\beta S}(T_i)$.
  Then $\mathbf{Q}$ is a compact subsemigroup of $\beta S$.
  Let $\la E_i \ra_{i \in D}$ and $\la I_i \ra_{i \in D}$ be decreasing families of nonempty subsets of $\bigtimes_{f \in F} S$ with the following properties:
  \begin{itemize}
    \item[(a)]
      For each $i \in D$, $I_i \subseteq E_i$. 

    \item[(b)]
      For each $i \in D$ and every $\vec{x} \in I_i$, there exists $j \in D$ such that $\vec{x}E_j \subseteq I_i$.

    \item[(c)]
      For each $i \in D$ and every $\vec{x} \in E_i \setminus I_i$, there exists $j \in D$ such that $\vec{x} E_j \subseteq E_i$ and $\vec{x}I_j \subseteq I_i$.
  \end{itemize}

  Let $Y = \bigtimes_{f \in F} \beta S$, let $E = \bigcap_{i \in D} c\ell_{Y}(E_i)$, and let $I = \bigcap_{i \in D} c\ell_Y(I_i)$.
  Then $E$ is a subsemigroup of $\bigtimes_{f \in F} \mathbf{Q}$ and $I$ is an ideal of $E$. 
  Additionally, if either 
  \begin{itemize}
    \item[(d)]
      for each $i \in D$, $T_i = S$ and $\{\, a \in S : \overline{a} \not\in E_i \,\}$ is \emph{not} piecewise syndetic, or

    \item[(e)]
      for each $i \in D$ and each $a \in T_i$, $\overline{a} \in E_i$,
  \end{itemize}
then given any $p \in K(\mathbf{Q})$, we have $\overline{p} \in E \cap K(\bigtimes_{f \in F} \mathbf{Q}) = K(E) \subseteq I$. 
\end{lem}

\begin{thm}
  \label{thm:csets}
  Let $(S, \cdot)$ be a semigroup and let $A \subseteq S$. 
  Then $A$ is a $C$-set if and only if there exists an idempotent in $p \in \overline{A} \cap J(S)$.
\end{thm}
\begin{proof}
  ($\Rightarrow$)
  Pick $m \colon \Pf(\calT) \to \bbN$, $\alpha \in \bigtimes_{F \in \Pf(\calT)} S^{m(F)+1}$, and $\tau \in \bigtimes_{F \in \Pf(\calT)} \calJ_{m(F)}$ as guaranteed by the definition of a $C$-set. 
  For each $F \in \Pf(\calT)$ define 
  \begin{align*}
    T(F) &= \bigl\{\, \textstyle \prod_{i=1}^n x(m(F_i), \alpha(F_i), \tau(F_i), f_i) : \mbox{$n \in \bbN$, for each $i \in \{1, 2, \ldots, n\}$, $F_i \in \Pf(\calT)$,}\\
 &\hspace{12em}\mbox{$F \subsetneq F_1 \subsetneq F_2 \subsetneq \cdots \subsetneq F_n$, $\la f_i \ra_{i=1}^n \in \bigtimes_{i=1}^n F_i$} \,\bigr\}.
  \end{align*}

  Observe for each $F \in \Pf(\calT)$, $T(F)$ is a nonempty subset of $A$, and the collection $\{\, T(F) : F \in \Pf(\calT) \,\}$ has the finite intersection property since $T(F \cup G) \subseteq T(F) \cap T(G)$ for all $F$, $G \in \Pf(\calT)$.
  Therefore $\mathbf{Q} = \bigcap_{F \in \Pf(\calT)} c\ell_{\beta S}\bigl(T(F)\bigr)$ is a closed nonempty subset of $\beta S$. 

  We show that $\mathbf{Q}$ is in fact a subsemigroup of $\beta S$.
  To see that $\mathbf{Q}$ is a subsemigroup it suffices, by \cite[Theorem 4.20]{Hindman:1998fk}, to show that for all $F \in \Pf(\calT)$ and for every $y \in T(F)$, there exists $G \in \Pf(\calT)$ such that $yT(G) \subseteq T(F)$. 
  So let $F \in \Pf(\calT)$ and $y \in T(F)$.
  Pick $n \in \bbN$, for every $i \in \{1, 2, \ldots, n\}$ pick $F_i \in \Pf(\calT)$ with $F \subsetneq F_1 \subsetneq F_2 \subsetneq \cdots F_n$, and $\la f_i \ra_{i=1}^n \in \bigtimes_{i=1}^n F_i$ such that $y = \prod_{i=1}^n x(m(F_i), \alpha(F_i), \tau(F_i), f_i)$. 
  We show that $yT(F_n) \subseteq T(F)$.
  Let $z \in T(F_n)$ and pick $m \in \bbN$, for every $i \in \{1, 2, \ldots, m\}$ pick $G_i \in \Pf(\calT)$ with $F_n \subsetneq G_1 \subsetneq G_2 \subsetneq \cdots \subsetneq G_m$, and pick $\la g_i \ra_{i=1}^m \in \bigtimes_{i=1}^m G_i$ such that $z = \prod_{i=1}^m x(m(G_i), \alpha(G_i), \tau(G_i), g_i)$.

  For each $i \in \{1, 2, \ldots, n+m\}$ define 
  \[
    H_i = 
    \begin{cases}
      F_i & \mbox{if $i \in \{1, 2, \ldots, n\}$,} \\
      G_{i-n} & \mbox{if $i \in \{n+1, n+2, \ldots, n+m\}$,}
    \end{cases}
  \]
  and define the sequence
  \[
    h_i =
    \begin{cases}
      f_i & \mbox{if $i \in \{1, 2, \ldots, n\}$,} \\
      g_{i-n} & \mbox{if $i \in \{n+1, n+2, \ldots, n+m\}$.}
    \end{cases}
  \]
  Then $F \subsetneq H_1 \subsetneq H_2 \subsetneq \cdots \subsetneq H_{n+m}$, $\la h_i \ra_{i=1}^{n+m} \in \bigtimes_{i=1}^{n+m} H_i$, and 
  \[
    \textstyle
    yz = \prod_{i=1}^{n+m} x(m(H_i), \alpha(H_i), \tau(H_i), h_i) \in T(F)
  \]
  Hence $\mathbf{Q}$ is a subsemigroup of $\beta S$. 

  We now claim that $K(\mathbf{Q}) \subseteq \overline{A} \cap J(S)$. 
  If this claim is true, then we are done since any idempotent in $K(\mathbf{Q})$ will establish the theorem. 
  Since $\mathbf{Q} \subseteq c\ell_{\beta S} (A)$, it evident that $K(\mathbf{Q}) \subseteq c\ell_{\beta S} (A)$. 

  Now let $p \in K(\mathbf{Q})$ and $B \in p$.
  Using \cite[Lemma 14.9]{Hindman:1998fk} we shall show that $B$ is a $J$-set. 
  Let $F \in \Pf(\calT)$ and put $D = \{\, G \in \Pf(\calT) : F \subseteq G \,\}$. 
  Observe $\mathbf{Q} = \bigcap_{G \in D} c\ell_{\beta S} (T(G))$.

  For $G \in D$, define $I(G) \subseteq \bigtimes_{f \in F} S$ as follows: for $w \in \bigtimes_{f \in F} S$, $w \in I(G)$ if and only if there is some $n \in \bbN \setminus \{1\}$ such that 
  \begin{itemize}
    \item[(1)]
      there exist disjoint nonempty sets $C_1$ and $C_2$ with $\{1, 2, \ldots, n\} = C_1 \cup C_2$, 
      
    \item[(2)]
      there exists a strictly increasing sequence $\la G_i \ra_{i=1}^n$ in $\Pf(\calT)$ with $G \subsetneq G_1$, and

    \item[(3)]
      there exists $\sigma \in \bigtimes_{i \in C_1} G_i$, 
  \end{itemize}
such that for every $f \in F$, if $\gamma_f \in \bigtimes_{i=1}^n G_i$ is defined by 
  \[
    \gamma_f(i) = 
    \begin{cases}
      \sigma(i) & \mbox{if $i \in C_1$,} \\
      f & \mbox{if $i \in C_2$,} 
    \end{cases}
  \]
then $w(f) = \prod_{i=1}^n x(m(G_i), \alpha(G_i), \tau(G_i), \gamma_f(i))$.
  For each $G \in D$, define $E(G) = I(G) \cup \{\, \overline{b} : b \in T(G) \,\}$. 

  We claim that $\la E(G) \ra_{G \in D}$ and $\la I(G) \ra_{G \in D}$ satisfy statements (a), (b), (c), and (e) of \cite[Lemma 14.9]{Hindman:1998fk}.

  Assume, temporarily, that our claim is true. 
  Then by \cite[Lemma 14.9]{Hindman:1998fk} if $Y = \bigtimes_{f \in F} \beta S$, $E = \bigcap_{G \in D} c\ell_Y(E(G))$, and $I = \bigcap_{G \in D} c\ell_Y(I(G))$, then $E$ is a subsemigroup of $Y$, $I$ is an ideal of $E$, and for every $p \in K(\mathbf{Q})$, $\overline{p} = (p, p, \ldots, p) \in K(E) \subseteq I$. 
  Since $\bigtimes_{f \in F} c\ell_{\beta S} (B)$ is a neighborhood of $\overline{p}$ we can pick $w \in I(F) \cap \bigtimes_{f \in F} c\ell_{\beta S} (B)$. 
  Pick $n \in \bbN\setminus \{1\}$, $C_1$, $C_2$, $\la G_i \ra_{i=1}^n$, and $\sigma \in \bigtimes_{i \in C_1} G_i$ as guaranteed by the definition of $I(F)$. 
  Put $r = |C_2|$ and enumerate $C_2$ as a strictly increasing sequence $h_1$, $h_2$, \dots, $h_r$.
  Put $u = \sum_{i=1}^r m(G_i)$.
  We define $c \in S^{u+1}$ and $t \in \calJ_u$ such that for all $f \in F$, $x(u, c, t, f) \in B$.

  Define $c \in S^{u+1}$ as follows:
  \[
    c(1) = 
    \begin{cases}
      \alpha(G_1)(1) & \mbox{if $h_1 = 1$,} \\
      \bigl(\prod_{i=1}^{h_1-1} x(m(G_i), \alpha(G_i), \tau(G_i), \sigma(i))\bigr) \cdot \alpha(G_{h_1})(1) & \mbox{if $h_1 > 1$.}
    \end{cases}
  \]
  For each positive integer $j$ with $1 < j < m(G_{h_1})$ put $c(j) = \alpha(G_{h_2})(j)$, and for each positive integer $j$ with $1 \le j \le m(G_{h_1})$ define $t_j = \tau(G_{h_1})(1)$. 

  Now for each $s \in \{1, 2, \ldots, u-1\}$ put $v_s = \sum_{i=1}^s m(G_{h_i})$, and define
  \[
    c(v_s+1) = 
    \begin{cases}
      \alpha(G_{h_s})(m(G_{h_s}+1))\alpha(G_{h_{s+1}})(1) & \mbox{if $h_{s+1} = h_s + 1$,} \\

      \alpha(G_{h_s})(m(G_{h_s}+1))\cdot & \\
      \hspace{3.5em}\bigl(\prod_{i=h_{s}+1}^{h_{s+1}-1} x(m(G_i), \alpha(G_i), \tau(G_i), \sigma(i))\bigr)\alpha(G_{h_{s+1}})(1) & \mbox{if $h_{s+1} > h_s+1$.}
    \end{cases}
  \]
  For each $s \in \{1, 2, \ldots, u-1\}$ and every positive integer $j$ with $v_s < j \le \sum_{i=1}^{s+1} m(G_{h_i})$ put $t_j = \tau(G_{h_{s+1}})(j-u)$. 
  Finally, we define
  \[
    c(u+1) = 
    \begin{cases}
      \alpha(G_{h_r})(m(G_n) + 1) & \mbox{if $h_r = n$,} \\
      \alpha(G_{h_r})(m(G_{h_r}+1))\prod_{i=h_r+1}^n x(m(G_i), \alpha(G_i), \tau(G_i), \sigma(i)) & \mbox{if $h_r < n$.}
    \end{cases}
  \]
  Then for every $f \in F$, $x(u, c, t, f) \in B$, and so $B$ is a $J$-set.

  We now prove our claim that the families $\la E(G) \ra_{G \in D}$ and $\la I(G) \ra_{G \in D}$ satisfy statements (a), (b), (c), and (e) of \cite[Lemma 14.9]{Hindman:1998fk}.

  By definition of $\la E(G) \ra_{G \in D}$ and $\la I(G) \ra_{G \in D}$ it is immediate that statements (a) and (e) are satisfied. 

  We now show statement (b) which states that for every $G \in D$ and each $w \in I(G)$ there exists $H \in D$ such that $w E(H) \subseteq I(G)$.
  Let $G \in D$ and $w \in I(G)$. 
  Pick $n \in \bbN$, $C_1$, $C_2$, $\la G_i \ra_{i=1}^n$, and $\sigma \in \bigtimes_{i \in C_1} G_i$ as guaranteed by the definition of $I(G)$..
  We show that $w E(G_n) \subseteq I(G)$. 
  Let $z \in E(G_n)$. 
  First assume that $z = \overline{b}$ for some $b \in T(G_n)$. 
  Pick $m \in \bbN$, for each $i \in \{1, 2, \ldots, m\}$ pick $F_i \in \Pf(\calT)$ with $G_n \subsetneq F_1 \subsetneq F_2 \subsetneq \cdots \subsetneq F_n$, and pick $\la f_i \ra_{i=1}^n \in \bigtimes_{i=1}^n F_i$ such that $b = \prod_{i=1}^m x(m(F_i), \alpha(F_i), \tau(F_i), f_i)$. 
  Put $D_1 = C_1 \cup \{n+1, n+2, \ldots, n+m\}$ and for each $i \in \{1, 2, \ldots, n+m\}$ put 
  \[
    H_i = 
    \begin{cases}
      G_i & \mbox{if $i \le n$,} \\
      F_{i-n} & \mbox{if $i > n$.}
    \end{cases}
  \]
  Define $\rho \in \bigtimes_{i \in D_1} H_i$ by 
  \[
    \rho(i) =
    \begin{cases}
      \sigma(i) & \mbox{if $i \le n$,} \\
      f_{i-n} & \mbox{if $i > n$.}
    \end{cases}
  \]
  Then with $n+m$, $D_1$, $C_2$, $\la H_i \ra_{i=1}^{n+m}$, and $\rho$ we have that $w \cdot z \in I(G)$. 

  Now we assume that $z \in I(G_n)$. 
  Pick $m \in \bbN$, $D_1$, $D_2$, $\la F_i \ra_{i=1}^m$, and $\rho$ as guaranteed by the definition of $I(G_n)$. 
  Put $E_1 = C_1 \cup \{\,n + i : i \in D_1 \,\}$ and put $E_2 = C_2 \cup \{\, n + i : i \in D_2 \,\}$.
  For each $i \in \{1, 2, \ldots, n+m\}$ put
  \[
    H_i = 
    \begin{cases}
      G_i & \mbox{if $i \le n$,} \\
      F_{i-n} & \mbox{if $i > n$.}
    \end{cases}
  \]
  Define $\mu \in \bigtimes_{i \in E_i} H_i$ by
  \[
    \mu(i) = 
    \begin{cases}
      \sigma(i) & \mbox{if $i \le n$,} \\
      \rho(i) & \mbox{if $i > n$.}
    \end{cases}
  \]
  Then with $n+m$, $E_1$, $E_2$, $\la H_i \ra_{i=1}^{n+m}$, and $\mu$ we have that $w \cdot z \in I(G)$.

  We now verify statement (c) which states that for all $G \in D$ and every $w \in E(G) \setminus I(G)$, there exists $H \in D$ such that $wE(H) \subseteq E(G)$ and $wI(H) \subseteq I(G)$.
  So let $G \in D$ and $w \in E(G) \setminus I(G)$. 
  Pick $b \in T(G)$ such that $w = \overline{b}$. 
  Pick $n \in \bbN$, for each $i \in \{1, 2, \ldots, n\}$ pick $G_i \in \Pf(\calT)$ with $G \subsetneq G_1 \subsetneq G_2 \subsetneq \cdots \subsetneq G_n$, and pick $\la f_i \ra_{i=1}^n \in \bigtimes_{i=1}^n G_i$ such that $b = \prod_{i=1}^n x(m(G_i), \alpha(G_i), \tau(G_i), f_i)$. 
  Then similar to what we have done above, we have that $wE(G_n) \subseteq E(G)$ and $wI(G_n) \subseteq I(G)$.

  This finishes this direction of our proof. 

  ($\Leftarrow$)
  Let $p = p \cdot p \in \overline{A} \cap J(S)$.
  Since $A \in p$ and $p$ is an idempotent we have, by \cite[Lemma 4.14]{Hindman:1998fk}, that $x^{-1}A^\star \in p$ for all $x \in A^\star$ where $A^\star = \{\, x \in A : x^{-1}A \in p\}$. 
  We will recursively define our functions $m$, $\alpha$, and $\tau$ by the size of $F \in \Pf(\calT)$ such that we satisfy, for $F \in \Pf(\calT)$, the following hypothesis:
  \begin{itemize}
    \item[(1)] If $\emptyset \ne G \subsetneq F$, then $\tau(G)\bigl( m(G) \bigr) < \tau(F)(1)$.
    
    \item[(2)] If $n \in \bbN$, $\emptyset \ne G_1 \subsetneq G_2 \subsetneq \cdots \subsetneq G_n = F$, and $\la f_i \ra_{i=1}^n \in \bigtimes_{i=1}^n G_i$, then \[\textstyle \prod_{i=1}^n x(m(G_i), \alpha(G_i), \tau(G_i), f_i)) \in A^\star.\]
  \end{itemize}

  Let $F \in \Pf(\calT)$.
  First, assume that $|F| = 1$, that is $F = \{f\}$ for some sequence $f \in \calT$.
  Since $A^\star$ is a $J$-set, pick $m(F) \in \bbN$, $\alpha(F) \in S^{m(F)+1}$, and $\tau(F) \in \calJ_{m(F)}$ such that $x(m(F), \alpha(F), \tau(F), f) \in A^\star$. 

  Now assume that $|F| > 1$ and for all $\emptyset \ne G \subsetneq F$ we have defined $m(G)$, $\alpha(G)$, and $\tau(G)$ so that hypotheses (1) and (2) hold.
  Put 
  \begin{align*}
    M &= \bigl\{\, \textstyle \prod_{i=1}^n x(m(G_i), \alpha(G_i), \tau(G_i), f_i) : \mbox{$n \in \bbN$, $\emptyset \ne G_1 \subsetneq G_2 \subsetneq \cdots \subsetneq G_n \subsetneq F$} \\
    &\hspace{12em} \mbox{and $\la f_i \ra_{i=1}^n \in \bigtimes_{i=1}^n G_i$} \,\bigr\}.
  \end{align*}
  Observe that since $F$ is finite, $M$ is also finite.
  By hypothesis (2) we have that $M \subseteq A^\star$.
  Put $B = A^\star \cap \bigcap_{x \in M} x^{-1}A^\star$, then $B \in p$ and so $B$ is a $J$-set. 

  For each $\emptyset \ne G \subsetneq F$, put $l(G) = \tau(G)\bigl( m(G) \bigr)$ and put $k = \max\{\, l(G) : \emptyset \ne G \subsetneq F \,\}$.
  By Lemma \ref{lem:jset-start}, pick $m(F) \in \bbN$, $\alpha(F) \in S^{m(F)+1}$, and $\tau(F) \in \calJ_{m(F)}$ such that $\tau(F)(1) > k$ and for every $f \in F$, $x(m(F), \alpha(F), \tau(F), f) \in B$.
  Hypothesis (1) is satisfied, since $\tau(F)(1) > k \ge \max l(G)$ for all $\emptyset \ne G \subsetneq F$.
  We show that hypothesis (2) is also satisfied.
  Let $n \in \bbN$, $\emptyset \ne G_1 \subsetneq G_2 \subsetneq \cdots \subsetneq G_{n-1} \subsetneq G_n = F$, and $\la f_i \ra_{i=1}^n \bigtimes_{i=1}^n G_i$. 
  If $n = 1$, then $x(m(G_1), \alpha(G_1), \tau(G_1), f) \in B \subseteq A^\star$.
  Now assume that $n > 1$ and put $y = \prod_{i=1}^{n-1} x(m(G_i), \alpha(G_i), \tau(G_i), f_i)$. 
  By definition $y \in M$ and since $x(m(G_n), \alpha(G_n), \tau(G_n), f_n) = x(m(F), \alpha(F), \tau(F), f_n) \in B \subseteq y^{-1}A^\star$ we have
  \[
    \textstyle
    \prod_{i=1}^n x(m(G_i), \alpha(G_i), \tau(G_i), f_i) = y \cdot x(m(F), \alpha(F), \tau(F), f_n) \in A^\star.
  \]
  Hence hypotheses (1) and (2) are satisfied and this completes the proof for this direction.
\end{proof}

It's reasonably clear that any semigroup $S$ is a $C$-set in itself.
Then Theorem \ref{thm:csets} shows that there is an idempotent in $J(S)$ and hence $J(S)$ is nonempty.
The Central Sets Theorem is simply the assertion that central sets are $C$-sets. 

\begin{cor}[Central Sets Theorem]
  \label{cor:cst}
  Every central set in a semigroup is a $C$-set.
\end{cor}
\begin{proof}
  Let $(S, \cdot)$ be a semigroup with $A \subseteq S$ a central set. 
  Since $A$ is a central set, there exists an idempotent $p \in K(\beta S)$ with $A \in p$.
  Since $K(S) \subseteq J(S)$, we have that $A$ is also a $C$-set.
\end{proof}
\begin{rmk}
  Unfortunately, despite its name the Central Sets Theorem does not characterize central sets. 
  See \cite{Hindman:2007fk} for an example of a $C$-set in $\bbN$ which is not a central set.   
\end{rmk}

Similar to how the definition of a $J$-set is simpler when the underlying semigroup is commutative we have the following result which shows that $C$-sets also have a simpler characterization when the underlying semigroup is commutative. 

\begin{thm}
  Let $(S, +)$ be a commutative semigroup and $A \subseteq S$.
  Then $A$ is a $C$-set if and only if there exist functions $\alpha \colon \Pf(\calT) \to S$ and $H \colon \Pf(\calT) \to \Pf(\bbN)$ such that
  \begin{itemize}
    \item[(1)] if $F$, $G \in \Pf(\calT)$ with $F \subsetneq G$, then $\max H(F) < \min H(G)$, and
    
    \item[(2)] whenever $m \in \bbN$, $G_1$, $G_2$, \dots, $G_m \in \Pf(\calT)$ with $G_1 \subsetneq G_2 \subsetneq \cdots \subsetneq G_m$, and for each $i \in \{1, 2, \ldots, m\}$, $f_i \in G_i$, we have $\sum_{i=1}^m\bigl( \alpha(G_i) + \sum_{t \in H(G_i)} f_i(t)\bigr) \in A$.
  \end{itemize}
\end{thm}
\begin{proof}
  ($\Rightarrow$)
  Since $A$ is a $C$-set, we also have that $A$ is a $J$-set in a commutative semigroup.
  By Theorem \ref{thm:csets} we also know that $A \in p$ for some idempotent $p \in J(S)$. 
  We will recursively define our functions $\alpha$ and $H$ by the size of $F \in \Pf(\calT)$ such that we satisfy, for $F \in \Pf(\calT)$, the following hypotheses:
  \begin{itemize}
    \item[(i)] If $\emptyset \ne G \subsetneq F$, then $\max H(G) < \min H(F)$.
      
    \item[(ii)] If $n \in \bbN$, $\emptyset \ne G_1 \subsetneq G_2 \subsetneq \cdots \subsetneq G_n = F$, and $\la f_i \ra_{i=1}^n \in \bigtimes_{i=1}^n G_i$, then $\sum_{i=1}^n\bigl( \alpha(G_i) + \sum_{t \in H(G_i)} f_i(t)\bigr) \in A^\star$. 
  \end{itemize}
  
  Let $F \in \Pf(\calT)$.
  First, assume that $|F| = 1$, that is, $F = \{f\}$ for some sequence $f \in \calT$.
  Since $A^\star$ is a $J$-set (in a commutative semigroup), we may pick $\alpha(F) \in S$ and $H(F) \in \Pf(\bbN)$ such that $\alpha(F) + \sum_{t \in H(F)} f(t) \in A^\star$.

  Now assume that $|F| > 1$ and for all $\emptyset \ne G \subsetneq F$ we have defined $\alpha(G)$ and $H(G)$ so that hypotheses (i) and (ii) hold.
  Put
  \begin{align*}
    M &=\textstyle \bigl\{\, \sum_{i=1}^n \bigl( \alpha(G_i) + \sum_{t \in G_i} f_i(t) \bigr) : \mbox{$n \in \bbN$, $\emptyset \ne G_1 \subsetneq G_2 \subsetneq \cdots \subsetneq G_n \subsetneq F$,} \\
    &\hspace{12em} \mbox{and $\la f_i \ra_{i=1}^n \in \bigtimes_{i=1}^n G_i$} \,\bigr\}.
  \end{align*}
  Since $F$ is finite, $M$ is also finite and by hypothesis (ii) we have that $M \subseteq A^\star$.
  Put $B = A^\star \cap \bigcap_{x \in M} -x+A^\star$, then $B \in p$ and so $B$ is also a $J$-set.

  Put $k = \max \bigl( \bigcup\{\, H(G) : \emptyset \ne G \subsetneq F\,\} \bigr)$.
  Since $B$ is a $J$-set, pick $\alpha(F) \in S$ and $H(F) \in \Pf(\bbN)$ with $\min H(F) > k$ such that for all $f \in F$, $\alpha(F) + \sum_{t \in H(F)} f(t) \in B$. 

  Now hypothesis (i) is satisfied since $\min H(F) > k \ge \max H(G)$ for all $\emptyset \ne G \subsetneq F$. 
  We show that hypothesis (ii) is also satisfied.
  Let $n \in \bbN$, $\emptyset \ne G_1 \subsetneq G_2 \subsetneq \cdots \subsetneq G_n = F$, and $\la f_i \ra_{i=1}^n \in \bigtimes_{i=1}^n G_i$. 
  If $n = 1$, then $\sum_{i=1}^n \bigl( \alpha(G_i) + \sum_{t \in H(G_i)} f_i(t)\bigr) = \alpha(F) + \sum_{t \in H(F)} f_1(t) \in B \subseteq A^\star$. 
  Now assume that $n > 1$ and let $y = \sum_{i=1}^{n-1}\bigl( \alpha(G_i) + \sum_{t \in H(G_i)} f_i(t) \bigr)$.
  Then $y \in M$ and so $\alpha(G_n) + \sum_{t \in H(G_n)} f_n(t) = \alpha(F) + \sum_{t \in H(F)} f_n(t) \in B \subseteq -y + A^\star$. 
  Hence $\sum_{i=1}^n\bigl( \alpha(G_i) + \sum_{t \in H(G_i)} f_i(t) \bigr) \in A^\star$.

  ($\Leftarrow$)
  If $|S| = 1$, then $|\calT| = 1$ and the implication trivially follows. 
  Therefore we may assume that $|S| \ge 2$ and hence $\calT$ is uncountable. 

  Fix $b \in S$, and for each $f \in \calT$ define $g_f \in \calT$ as $g_f(t) = f(t) + b$. 
  We shall recursively define a family $\la G(F) \ra_{F \in \Pf(\calT)}$ in $\Pf(\calT)$ such that for all $F \in \Pf(\calT)$ the following hypotheses are satisfied: 
  \begin{itemize}
    \item[(i)]
      $\{\, g_f : f \in F \,\} \subseteq G(F)$.

    \item[(ii)]
      For all $F' \in \Pf(\calT)$, if $F' \subsetneq F$, then $G(F') \subsetneq G(F)$. 
  \end{itemize}

  Let $F \in \Pf(\calT)$. 
  If $|F| = 1$, then put $G(F) = \{\, g_f : f \in F \,\}$.
  Observe that $G(F)$ satisfies hypothesis (i), and vacuously satisfies hypothesis (ii).

  Now suppose $|F| > 1$ and that for all $F' \in \Pf(\calT)$ with $|F'| < |F|$ we have defined $G(F')$ such that hypotheses (i) and (ii) are satisfied. 
  In particular for all nonempty $F' \subsetneq F$, the set $G(F')$ is properly defined. 
  Put $\calH = \bigcup\{\, G(F') : \emptyset \ne F' \subsetneq F \,\} \cup \{\, g_f : f \in F \,\}$, and observe that $\calH$ is finite. 
  Hence we can pick $h \in \calT \setminus \calH$ and define $G(F) = \calH \cup \{h\}$. 
  That $G(F)$ satisfies hypothesis (i) is clear. 
  To see that hypothesis (ii) is satisfied, let $F' \in \Pf(\calT)$ with $F' \subsetneq F$.
  Then since $G(F') \subseteq \calH$ and $h \not\in \calH$ we have $G(F') \subsetneq G(F)$.   
  
  Pick $\alpha \colon \Pf(\calT) \to S$ and $H \colon \Pf(\calT) \to \Pf(\bbN)$ as guaranteed by assumption.
  We shall use the family $\la G(F) \ra_{F \in \Pf(\calT)}$ to construct the functions $p \colon \Pf(\calT) \to \bbN$, $\beta \in \bigtimes_{F \in \Pf(\calT)} S^{m(F)+1}$, and $\tau \in \bigtimes_{F \in \Pf(\calT)} \calJ_{m(F)}$ as required by Definition \ref{defn:csets}.

  First define $p \colon \Pf(\calT) \to \bbN$ by $p(F) = |H\bigl( G(F) \bigr)|$ for all $F \in \Pf(\calT)$. 
  Define $\beta \in \bigtimes_{F \in \Pf(\calT)} S^{m(F)+1}$ as follows:
  For $F \in \Pf(\calT)$ and $i \in \{1, 2, \ldots, p(F)+1\}$
  \[
    \beta(F)(i) =
    \begin{cases}
      \alpha \bigl( G(F) \bigr) & \mbox{if $i=1$,} \\
      b & \mbox{if $i > 2$}.
    \end{cases}
  \]
  Define $\tau \in \bigtimes_{F \in \Pf(\calT)} \calJ_{m(F)}$ as follows:
  For $F \in \Pf(\calT)$ enumerate $H \bigl( G(F) \bigr)$ as a strictly increasing sequence $t_1 < t_2 < \cdots < t_{p(F)}$, and for each $i \in \{1, 2, \ldots, p(F)\}$ put $\tau(F)(i) = t_i$.
  
  Let $F$, $F' \in \Pf(\calT)$ with $F' \subsetneq F$. 
  By construction of the family $\la G(F) \ra_{F \in \Pf(\calT)}$ we have that $G(F') \subsetneq G(F)$.
  Hence $\tau(F')\bigl( p(F') \bigr) = \max H \bigl( G(F') \bigr) < \min H \bigl( G(F) \bigr) = \tau(F)(1)$

  Let $n \in \bbN$, and let $F_1$, $F_2$, \ldots, $F_n$ be elements of $\Pf(\calT)$ with $F_1 \subsetneq F_2 \subsetneq \cdots \subsetneq F_n$. 
  If $\la f_i \ra_{i=1}^n \in \bigtimes_{i=1}^n F_i$, then 
  \begin{align*}
    \textstyle
    \sum_{i=1}^n x(p(F_i), \beta(F_i), \tau(F_i), f_i) 
    &= \textstyle \sum_{i=1}^n \biggl( \sum_{j=1}^{p(F_i)} \Bigl( \beta(F_i)(j) + f_i\bigl(\tau(F_i)(j)\bigr)\Bigr) \\
    &\hspace{2em} + \beta(F_i)(m(F_i)+1) \biggr),  \\
    &= \textstyle \sum_{i=1}^n \biggl( \beta(F_i)(1) + f_i\bigl( \tau(F_i)(1)\bigr) \\ 
    &\hspace{2em} \textstyle + \sum_{j=2}^{p(F_i)} \Bigl( \beta(F_i)(j) + f_i\bigl(\tau(F_i)(j)\bigr)\Bigr) + \beta(F_i)(m(F_i)+1) \biggr), \\
    &= \textstyle \sum_{i=1}^n \biggl( \alpha\bigl( G(F_i) \bigr) + f_i\bigl( \tau(F_i)(1)\bigr) + \\
    &\hspace{2em} \textstyle \sum_{j=2}^{p(F_i)} \Bigl( b + f_i\bigl(\tau(F_i)(j)\bigr)\Bigr) + b \biggr), \\
    &= \textstyle \sum_{i=1}^n \biggl( \alpha\bigl( G(F_i) \bigr) +
    \textstyle \sum_{j=1}^{p(F_i)} \Bigl( f_i\bigl(\tau(F_i)(j)\bigr) + b\Bigr) \biggr), \\
    &= \textstyle \sum_{i=1}^n \Bigl( \alpha\bigl( G(F_i) \bigr) +
    \textstyle \sum_{j=1}^{p(F_i)} g_{f_i}\bigl(\tau(F_i)(j)\bigr) \Bigr).
  \end{align*}

  By our choice of $p$, $\beta$, and $\tau$ this last sum is an element of  $A$. 
  Hence $A$ is a $C$-set.

\end{proof}

 \theendnotes
